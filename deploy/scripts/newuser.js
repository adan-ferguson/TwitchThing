(()=>{"use strict";const t=document.querySelector("body > #loader");class e extends HTMLFormElement{_inputs;_errorMessage;submitButton;constructor(t){super(),t={async:!1,action:"",submitText:"Submit",success:()=>{},customFetch:!1,fullscreenLoading:!1,extraData:{},html:"",...t},this.options=t,this.classList.add("di-form"),this.innerHTML=`\n<div class="inputs">${t.html}</div>\n<div class="bottom">\n  <button type="submit"></button>\n  <div class="error-message hidden"></div>\n</div>\n`,this._inputs=this.querySelector(".inputs"),this.submitButton=this.querySelector("button"),this.submitButton.textContent=t.submitText,this._errorMessage=this.querySelector(".error-message"),t.action&&this.setAttribute("action",t.action),t.async&&this.addEventListener("submit",(async e=>{e.preventDefault(),this._loading();const s=t.action instanceof Function?await t.action():await async function(t,e=null){let s,n;try{const i={method:"post",headers:{"Content-Type":"application/json"}};return e&&(i.body=JSON.stringify(e)),s=await fetch(t,i),n=await s.text(),n?JSON.parse(n):{}}catch(e){return!s||s.status>=400?n?{error:n}:{error:e||`An error occurred during fizzetch of ${t}`}:{}}}(t.action,this.data());this._loadingFinished(),s.error?this.error(s.error):(t.success(s),this.dispatchEvent(new Event("success")))}))}data(){const t=new FormData(this),e={};Array.from(t.entries()).forEach((([t,s])=>e[t]=s));let s=this.options.extraData;return s="function"==typeof s?s():s,s=s||{},{...e,...s}}addInput(t,e=null){const s=document.createElement("input");for(let e in t)s.setAttribute(e,t[e]);this._addInput(s,e)}_addInput(t,e=null){const s=document.createElement("label");if(e){const t=document.createElement("span");t.textContent=e,s.appendChild(t)}s.appendChild(t),this._inputs.appendChild(s)}addSelect(t){t={label:null,name:"",optionsList:[],...t};const e=document.createElement("label");if(e.classList.add("flex-between"),t.label){const s=document.createElement("span");s.textContent=t.label,e.appendChild(s)}const s=document.createElement("select");return s.setAttribute("name",t.name),t.optionsList.forEach((({value:t,name:e})=>{const n=document.createElement("option");n.value=t,n.textContent=e,s.appendChild(n)})),e.appendChild(s),this._inputs.appendChild(e),s}error(t){t?.message&&(t=t.message),this._errorMessage.textContent=t,this._errorMessage.classList.remove("hidden")}_loading(){if(this.options.fullscreenLoading)return function(e=""){t.querySelector(".message").textContent=e,t.classList.add("show")}(this.options.fullscreenLoading.message??"");this._errorMessage.classList.add("hidden"),this.submitButton.disabled=!0,this.submitButton.innerHTML='<span class="spin-effect">DI</span>'}_loadingFinished(){this.options.fullscreenLoading?t.classList.remove("show"):(this.submitButton.disabled=!1,this.submitButton.textContent=this.options.submitText)}}customElements.define("di-form",e,{extends:"form"});const s=new e({submitText:"Save"});s.addInput({type:"text",name:"displayname",minLength:2,maxLength:15,required:"required",placeholder:"Choose a username"}),document.querySelector(".new-user-form").appendChild(s),window.ERROR&&s.error(window.ERROR)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVMsU0V0SnBELE1BQU1DLEVBQVMsSUFBSTVFLEVBQU8sQ0FDeEJVLFdBQVksU0FFZGtFLEVBQU9yQixTQUFTLENBQ2RzQixLQUFNLE9BQ05aLEtBQU0sY0FDTmEsVUFBVyxFQUNYQyxVQUFXLEdBQ1hDLFNBQVUsV0FDVkMsWUFBYSxzQkFFZm5GLFNBQVNDLGNBQWMsa0JBQWtCZ0UsWUFBWWEsR0FFbERNLE9BQU9DLE9BQ1JQLEVBQU9sQyxNQUFNd0MsT0FBT0MsTSIsInNvdXJjZXMiOlsid2VicGFjazovL215LXdlYnBhY2stcHJvamVjdC8uL2NsaWVudC9qcy9sb2FkZXIuanMiLCJ3ZWJwYWNrOi8vbXktd2VicGFjay1wcm9qZWN0Ly4vY2xpZW50L2pzL2NvbXBvbmVudHMvZm9ybS5qcyIsIndlYnBhY2s6Ly9teS13ZWJwYWNrLXByb2plY3QvLi9jbGllbnQvanMvZml6emV0Y2guanMiLCJ3ZWJwYWNrOi8vbXktd2VicGFjay1wcm9qZWN0Ly4vY2xpZW50L2pzL2VudHJ5UG9pbnRzL25ld3VzZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbG9hZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keSA+ICNsb2FkZXInKVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGhpZGVMb2FkZXIoKXtcclxuICBsb2FkZXIuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzaG93TG9hZGVyKG1lc3NhZ2UgPSAnJyl7XHJcbiAgbG9hZGVyLnF1ZXJ5U2VsZWN0b3IoJy5tZXNzYWdlJykudGV4dENvbnRlbnQgPSBtZXNzYWdlXHJcbiAgbG9hZGVyLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKVxyXG59IiwiaW1wb3J0IGZpenpldGNoIGZyb20gJy4uL2ZpenpldGNoLmpzJ1xyXG5pbXBvcnQgeyBoaWRlTG9hZGVyLCBzaG93TG9hZGVyIH0gZnJvbSAnLi4vbG9hZGVyLmpzJ1xyXG5cclxuY29uc3QgSFRNTCA9IChodG1sKSA9PiBgXHJcbjxkaXYgY2xhc3M9XCJpbnB1dHNcIj4ke2h0bWx9PC9kaXY+XHJcbjxkaXYgY2xhc3M9XCJib3R0b21cIj5cclxuICA8YnV0dG9uIHR5cGU9XCJzdWJtaXRcIj48L2J1dHRvbj5cclxuICA8ZGl2IGNsYXNzPVwiZXJyb3ItbWVzc2FnZSBoaWRkZW5cIj48L2Rpdj5cclxuPC9kaXY+XHJcbmBcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERJRm9ybSBleHRlbmRzIEhUTUxGb3JtRWxlbWVudHtcclxuXHJcbiAgX2lucHV0c1xyXG4gIF9lcnJvck1lc3NhZ2VcclxuICBzdWJtaXRCdXR0b25cclxuXHJcbiAgY29uc3RydWN0b3Iob3B0aW9ucyl7XHJcbiAgICBzdXBlcigpXHJcblxyXG4gICAgb3B0aW9ucyA9IHtcclxuICAgICAgYXN5bmM6IGZhbHNlLFxyXG4gICAgICBhY3Rpb246ICcnLFxyXG4gICAgICBzdWJtaXRUZXh0OiAnU3VibWl0JyxcclxuICAgICAgc3VjY2VzczogKCkgPT4ge30sXHJcbiAgICAgIGN1c3RvbUZldGNoOiBmYWxzZSxcclxuICAgICAgZnVsbHNjcmVlbkxvYWRpbmc6IGZhbHNlLFxyXG4gICAgICBleHRyYURhdGE6IHt9LFxyXG4gICAgICBodG1sOiAnJyxcclxuICAgICAgLi4ub3B0aW9uc1xyXG4gICAgfVxyXG4gICAgdGhpcy5vcHRpb25zID0gb3B0aW9uc1xyXG5cclxuICAgIHRoaXMuY2xhc3NMaXN0LmFkZCgnZGktZm9ybScpXHJcbiAgICB0aGlzLmlubmVySFRNTCA9IEhUTUwob3B0aW9ucy5odG1sKVxyXG4gICAgdGhpcy5faW5wdXRzID0gdGhpcy5xdWVyeVNlbGVjdG9yKCcuaW5wdXRzJylcclxuICAgIHRoaXMuc3VibWl0QnV0dG9uID0gdGhpcy5xdWVyeVNlbGVjdG9yKCdidXR0b24nKVxyXG4gICAgdGhpcy5zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBvcHRpb25zLnN1Ym1pdFRleHRcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZSA9IHRoaXMucXVlcnlTZWxlY3RvcignLmVycm9yLW1lc3NhZ2UnKVxyXG5cclxuICAgIGlmKG9wdGlvbnMuYWN0aW9uKXtcclxuICAgICAgdGhpcy5zZXRBdHRyaWJ1dGUoJ2FjdGlvbicsIG9wdGlvbnMuYWN0aW9uKVxyXG4gICAgfVxyXG5cclxuICAgIGlmKG9wdGlvbnMuYXN5bmMpe1xyXG4gICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGFzeW5jIGUgPT4ge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKVxyXG4gICAgICAgIHRoaXMuX2xvYWRpbmcoKVxyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG9wdGlvbnMuYWN0aW9uIGluc3RhbmNlb2YgRnVuY3Rpb24gPyBhd2FpdCBvcHRpb25zLmFjdGlvbigpIDogYXdhaXQgZml6emV0Y2gob3B0aW9ucy5hY3Rpb24sIHRoaXMuZGF0YSgpKVxyXG4gICAgICAgIHRoaXMuX2xvYWRpbmdGaW5pc2hlZCgpXHJcbiAgICAgICAgaWYocmVzdWx0LmVycm9yKXtcclxuICAgICAgICAgIHRoaXMuZXJyb3IocmVzdWx0LmVycm9yKVxyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgb3B0aW9ucy5zdWNjZXNzKHJlc3VsdClcclxuICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3N1Y2Nlc3MnKSlcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBkYXRhKCl7XHJcbiAgICBjb25zdCBkYXRhID0gbmV3IEZvcm1EYXRhKHRoaXMpXHJcbiAgICBjb25zdCBvYmogPSB7fVxyXG4gICAgQXJyYXkuZnJvbShkYXRhLmVudHJpZXMoKSkuZm9yRWFjaCgoW2tleSwgdmFsXSkgPT4gb2JqW2tleV0gPSB2YWwpXHJcblxyXG4gICAgbGV0IGV4dHJhID0gdGhpcy5vcHRpb25zLmV4dHJhRGF0YVxyXG4gICAgZXh0cmEgPSB0eXBlb2YgZXh0cmEgPT09ICdmdW5jdGlvbicgPyBleHRyYSgpIDogZXh0cmFcclxuICAgIGV4dHJhID0gZXh0cmEgPyBleHRyYSA6IHt9XHJcblxyXG4gICAgcmV0dXJuIHsgLi4ub2JqLCAuLi5leHRyYSB9XHJcbiAgfVxyXG5cclxuICBhZGRJbnB1dChvcHRpb25zLCBsYWJlbCA9IG51bGwpe1xyXG5cclxuICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKVxyXG4gICAgZm9yIChsZXQga2V5IGluIG9wdGlvbnMpe1xyXG4gICAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoa2V5LCBvcHRpb25zW2tleV0pXHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5fYWRkSW5wdXQoaW5wdXQsIGxhYmVsKVxyXG4gIH1cclxuXHJcbiAgX2FkZElucHV0KGlucHV0RWwsIGxhYmVsID0gbnVsbCl7XHJcblxyXG4gICAgY29uc3QgbGFiZWxFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJylcclxuICAgIGlmKGxhYmVsKXtcclxuICAgICAgY29uc3Qgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKVxyXG4gICAgICBzcGFuLnRleHRDb250ZW50ID0gbGFiZWxcclxuICAgICAgbGFiZWxFbC5hcHBlbmRDaGlsZChzcGFuKVxyXG4gICAgfVxyXG5cclxuICAgIGxhYmVsRWwuYXBwZW5kQ2hpbGQoaW5wdXRFbClcclxuICAgIHRoaXMuX2lucHV0cy5hcHBlbmRDaGlsZChsYWJlbEVsKVxyXG4gIH1cclxuXHJcbiAgYWRkU2VsZWN0KG9wdGlvbnMpe1xyXG5cclxuICAgIG9wdGlvbnMgPSB7XHJcbiAgICAgIGxhYmVsOiBudWxsLFxyXG4gICAgICBuYW1lOiAnJyxcclxuICAgICAgb3B0aW9uc0xpc3Q6IFtdLFxyXG4gICAgICAuLi5vcHRpb25zXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpXHJcbiAgICBsYWJlbC5jbGFzc0xpc3QuYWRkKCdmbGV4LWJldHdlZW4nKVxyXG4gICAgaWYob3B0aW9ucy5sYWJlbCl7XHJcbiAgICAgIGNvbnN0IHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJylcclxuICAgICAgc3Bhbi50ZXh0Q29udGVudCA9IG9wdGlvbnMubGFiZWxcclxuICAgICAgbGFiZWwuYXBwZW5kQ2hpbGQoc3BhbilcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzZWxlY3QnKVxyXG4gICAgc2VsZWN0LnNldEF0dHJpYnV0ZSgnbmFtZScsIG9wdGlvbnMubmFtZSlcclxuICAgIG9wdGlvbnMub3B0aW9uc0xpc3QuZm9yRWFjaCgoeyB2YWx1ZSwgbmFtZSB9KSA9PiB7XHJcbiAgICAgIGNvbnN0IG9wdGlvbnMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKVxyXG4gICAgICBvcHRpb25zLnZhbHVlID0gdmFsdWVcclxuICAgICAgb3B0aW9ucy50ZXh0Q29udGVudCA9IG5hbWVcclxuICAgICAgc2VsZWN0LmFwcGVuZENoaWxkKG9wdGlvbnMpXHJcbiAgICB9KVxyXG4gICAgbGFiZWwuYXBwZW5kQ2hpbGQoc2VsZWN0KVxyXG5cclxuICAgIHRoaXMuX2lucHV0cy5hcHBlbmRDaGlsZChsYWJlbClcclxuICAgIHJldHVybiBzZWxlY3RcclxuICB9XHJcblxyXG4gIGVycm9yKG1lc3NhZ2Upe1xyXG4gICAgaWYobWVzc2FnZT8ubWVzc2FnZSl7XHJcbiAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlLm1lc3NhZ2VcclxuICAgIH1cclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZS50ZXh0Q29udGVudCA9IG1lc3NhZ2VcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKVxyXG4gIH1cclxuXHJcbiAgX2xvYWRpbmcoKXtcclxuICAgIGlmKHRoaXMub3B0aW9ucy5mdWxsc2NyZWVuTG9hZGluZyl7XHJcbiAgICAgIHJldHVybiBzaG93TG9hZGVyKHRoaXMub3B0aW9ucy5mdWxsc2NyZWVuTG9hZGluZy5tZXNzYWdlID8/ICcnKVxyXG4gICAgfVxyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpXHJcbiAgICB0aGlzLnN1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWVcclxuICAgIHRoaXMuc3VibWl0QnV0dG9uLmlubmVySFRNTCA9ICc8c3BhbiBjbGFzcz1cInNwaW4tZWZmZWN0XCI+REk8L3NwYW4+J1xyXG4gIH1cclxuXHJcbiAgX2xvYWRpbmdGaW5pc2hlZCgpe1xyXG4gICAgaWYodGhpcy5vcHRpb25zLmZ1bGxzY3JlZW5Mb2FkaW5nKXtcclxuICAgICAgcmV0dXJuIGhpZGVMb2FkZXIoKVxyXG4gICAgfVxyXG4gICAgdGhpcy5zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZVxyXG4gICAgdGhpcy5zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLm9wdGlvbnMuc3VibWl0VGV4dFxyXG4gIH1cclxufVxyXG5cclxuY3VzdG9tRWxlbWVudHMuZGVmaW5lKCdkaS1mb3JtJywgRElGb3JtLCB7IGV4dGVuZHM6ICdmb3JtJyB9KSIsImV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uKHVybCwgZGF0YSA9IG51bGwpe1xyXG4gIGxldCByZXNwXHJcbiAgbGV0IHRleHRcclxuICB0cnkge1xyXG4gICAgY29uc3Qgb2JqID0ge1xyXG4gICAgICBtZXRob2Q6ICdwb3N0JyxcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmKGRhdGEpe1xyXG4gICAgICBvYmouYm9keSA9IEpTT04uc3RyaW5naWZ5KGRhdGEpXHJcbiAgICB9XHJcblxyXG4gICAgcmVzcCA9IGF3YWl0IGZldGNoKHVybCwgb2JqKVxyXG4gICAgdGV4dCA9IGF3YWl0IHJlc3AudGV4dCgpXHJcbiAgICByZXR1cm4gdGV4dCA/IEpTT04ucGFyc2UodGV4dCkgOiB7fVxyXG4gIH1jYXRjaChleCl7XHJcbiAgICBpZighcmVzcCB8fCByZXNwLnN0YXR1cyA+PSA0MDApe1xyXG4gICAgICBpZih0ZXh0KXtcclxuICAgICAgICByZXR1cm4geyBlcnJvcjogdGV4dCB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHsgZXJyb3I6IGV4IHx8IGBBbiBlcnJvciBvY2N1cnJlZCBkdXJpbmcgZml6emV0Y2ggb2YgJHt1cmx9YCB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4ge31cclxuICB9XHJcbn0iLCJpbXBvcnQgRElGb3JtIGZyb20gJy4uL2NvbXBvbmVudHMvZm9ybS5qcydcclxuXHJcbmNvbnN0IGRpZm9ybSA9IG5ldyBESUZvcm0oe1xyXG4gIHN1Ym1pdFRleHQ6ICdTYXZlJ1xyXG59KVxyXG5kaWZvcm0uYWRkSW5wdXQoe1xyXG4gIHR5cGU6ICd0ZXh0JyxcclxuICBuYW1lOiAnZGlzcGxheW5hbWUnLFxyXG4gIG1pbkxlbmd0aDogMixcclxuICBtYXhMZW5ndGg6IDE1LFxyXG4gIHJlcXVpcmVkOiAncmVxdWlyZWQnLFxyXG4gIHBsYWNlaG9sZGVyOiAnQ2hvb3NlIGEgdXNlcm5hbWUnXHJcbn0pXHJcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uZXctdXNlci1mb3JtJykuYXBwZW5kQ2hpbGQoZGlmb3JtKVxyXG5cclxuaWYod2luZG93LkVSUk9SKXtcclxuICBkaWZvcm0uZXJyb3Iod2luZG93LkVSUk9SKVxyXG59XHJcblxyXG4iXSwibmFtZXMiOlsibG9hZGVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiRElGb3JtIiwiSFRNTEZvcm1FbGVtZW50IiwiX2lucHV0cyIsIl9lcnJvck1lc3NhZ2UiLCJzdWJtaXRCdXR0b24iLCJjb25zdHJ1Y3RvciIsIm9wdGlvbnMiLCJzdXBlciIsImFzeW5jIiwiYWN0aW9uIiwic3VibWl0VGV4dCIsInN1Y2Nlc3MiLCJjdXN0b21GZXRjaCIsImZ1bGxzY3JlZW5Mb2FkaW5nIiwiZXh0cmFEYXRhIiwiaHRtbCIsInRoaXMiLCJjbGFzc0xpc3QiLCJhZGQiLCJpbm5lckhUTUwiLCJ0ZXh0Q29udGVudCIsInNldEF0dHJpYnV0ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwicHJldmVudERlZmF1bHQiLCJfbG9hZGluZyIsInJlc3VsdCIsIkZ1bmN0aW9uIiwidXJsIiwiZGF0YSIsInJlc3AiLCJ0ZXh0Iiwib2JqIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZmV0Y2giLCJwYXJzZSIsImV4Iiwic3RhdHVzIiwiZXJyb3IiLCJmaXp6ZXRjaCIsIl9sb2FkaW5nRmluaXNoZWQiLCJkaXNwYXRjaEV2ZW50IiwiRXZlbnQiLCJGb3JtRGF0YSIsIkFycmF5IiwiZnJvbSIsImVudHJpZXMiLCJmb3JFYWNoIiwia2V5IiwidmFsIiwiZXh0cmEiLCJhZGRJbnB1dCIsImxhYmVsIiwiaW5wdXQiLCJjcmVhdGVFbGVtZW50IiwiX2FkZElucHV0IiwiaW5wdXRFbCIsImxhYmVsRWwiLCJzcGFuIiwiYXBwZW5kQ2hpbGQiLCJhZGRTZWxlY3QiLCJuYW1lIiwib3B0aW9uc0xpc3QiLCJzZWxlY3QiLCJ2YWx1ZSIsIm1lc3NhZ2UiLCJyZW1vdmUiLCJzaG93TG9hZGVyIiwiZGlzYWJsZWQiLCJjdXN0b21FbGVtZW50cyIsImRlZmluZSIsImV4dGVuZHMiLCJkaWZvcm0iLCJ0eXBlIiwibWluTGVuZ3RoIiwibWF4TGVuZ3RoIiwicmVxdWlyZWQiLCJwbGFjZWhvbGRlciIsIndpbmRvdyIsIkVSUk9SIl0sInNvdXJjZVJvb3QiOiIifQ==