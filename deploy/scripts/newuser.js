(()=>{"use strict";const t=document.querySelector("body > #loader");class e extends HTMLFormElement{_inputs;_errorMessage;submitButton;constructor(t){super(),t={async:!1,action:"",submitText:"Submit",success:()=>{},customFetch:!1,fullscreenLoading:!1,extraData:{},html:"",...t},this.options=t,this.classList.add("di-form"),this.innerHTML=`\n<div class="inputs">${t.html}</div>\n<div class="bottom">\n  <button type="submit"></button>\n  <div class="error-message hidden"></div>\n</div>\n`,this._inputs=this.querySelector(".inputs"),this.submitButton=this.querySelector("button"),this.submitButton.textContent=t.submitText,this._errorMessage=this.querySelector(".error-message"),t.action&&this.setAttribute("action",t.action),t.async&&this.addEventListener("submit",(async e=>{e.preventDefault(),this._loading();const s=t.action instanceof Function?await t.action():await async function(t,e=null){let s,n;try{const i={method:"post",headers:{"Content-Type":"application/json"}};return e&&(i.body=JSON.stringify(e)),s=await fetch(t,i),n=await s.text(),n?JSON.parse(n):{}}catch(e){return!s||s.status>=400?n?{error:n}:{error:e||`An error occurred during fizzetch of ${t}`}:{}}}(t.action,this.data());this._loadingFinished(),s.error?this.error(s.error):(t.success(s),this.dispatchEvent(new Event("success")))}))}data(){const t=new FormData(this),e={};Array.from(t.entries()).forEach((([t,s])=>e[t]=s));let s=this.options.extraData;return s="function"==typeof s?s():s,s=s||{},{...e,...s}}addInput(t,e=null){const s=document.createElement("input");for(let e in t)s.setAttribute(e,t[e]);this._addInput(s,e)}_addInput(t,e=null){const s=document.createElement("label");if(e){const t=document.createElement("span");t.textContent=e,s.appendChild(t)}s.appendChild(t),this._inputs.appendChild(s)}addSelect(t){t={label:null,name:"",optionsList:[],...t};const e=document.createElement("label");if(e.classList.add("flex-between"),t.label){const s=document.createElement("span");s.textContent=t.label,e.appendChild(s)}const s=document.createElement("select");return s.setAttribute("name",t.name),t.optionsList.forEach((({value:t,name:e})=>{const n=document.createElement("option");n.value=t,n.textContent=e,s.appendChild(n)})),e.appendChild(s),this._inputs.appendChild(e),s}error(t){t?.message&&(t=t.message),this._errorMessage.textContent=t,this._errorMessage.classList.remove("hidden")}_loading(){if(this.options.fullscreenLoading)return function(e=""){t.querySelector(".message").textContent=e,t.classList.add("show")}(this.options.fullscreenLoading.message??"");this._errorMessage.classList.add("hidden"),this.submitButton.disabled=!0,this.submitButton.innerHTML='<span class="spin-effect">DI</span>'}_loadingFinished(){this.options.fullscreenLoading?t.classList.remove("show"):(this.submitButton.disabled=!1,this.submitButton.textContent=this.options.submitText)}}customElements.define("di-form",e,{extends:"form"});const s=new e({submitText:"Save"});s.addInput({type:"text",name:"displayname",minLength:2,maxLength:15,required:"required",placeholder:"Choose a username"}),document.querySelector(".new-user-form").appendChild(s),window.ERROR&&s.error(window.ERROR)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UyxTRXRKcEQsTUFBTUMsRUFBUyxJQUFJNUUsRUFBTyxDQUN4QlUsV0FBWSxTQUVka0UsRUFBT3JCLFNBQVMsQ0FDZHNCLEtBQU0sT0FDTlosS0FBTSxjQUNOYSxVQUFXLEVBQ1hDLFVBQVcsR0FDWEMsU0FBVSxXQUNWQyxZQUFhLHNCQUVmbkYsU0FBU0MsY0FBYyxrQkFBa0JnRSxZQUFZYSxHQUVsRE0sT0FBT0MsT0FDUlAsRUFBT2xDLE1BQU13QyxPQUFPQyxNIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXktd2VicGFjay1wcm9qZWN0Ly4vY2xpZW50L2pzL2xvYWRlci5qcyIsIndlYnBhY2s6Ly9teS13ZWJwYWNrLXByb2plY3QvLi9jbGllbnQvanMvY29tcG9uZW50cy9mb3JtLmpzIiwid2VicGFjazovL215LXdlYnBhY2stcHJvamVjdC8uL2NsaWVudC9qcy9maXp6ZXRjaC5qcyIsIndlYnBhY2s6Ly9teS13ZWJwYWNrLXByb2plY3QvLi9jbGllbnQvanMvZW50cnlQb2ludHMvbmV3dXNlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBsb2FkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5ID4gI2xvYWRlcicpXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaGlkZUxvYWRlcigpe1xyXG4gIGxvYWRlci5jbGFzc0xpc3QucmVtb3ZlKCdzaG93JylcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNob3dMb2FkZXIobWVzc2FnZSA9ICcnKXtcclxuICBsb2FkZXIucXVlcnlTZWxlY3RvcignLm1lc3NhZ2UnKS50ZXh0Q29udGVudCA9IG1lc3NhZ2VcclxuICBsb2FkZXIuY2xhc3NMaXN0LmFkZCgnc2hvdycpXHJcbn0iLCJpbXBvcnQgZml6emV0Y2ggZnJvbSAnLi4vZml6emV0Y2guanMnXHJcbmltcG9ydCB7IGhpZGVMb2FkZXIsIHNob3dMb2FkZXIgfSBmcm9tICcuLi9sb2FkZXIuanMnXHJcblxyXG5jb25zdCBIVE1MID0gKGh0bWwpID0+IGBcclxuPGRpdiBjbGFzcz1cImlucHV0c1wiPiR7aHRtbH08L2Rpdj5cclxuPGRpdiBjbGFzcz1cImJvdHRvbVwiPlxyXG4gIDxidXR0b24gdHlwZT1cInN1Ym1pdFwiPjwvYnV0dG9uPlxyXG4gIDxkaXYgY2xhc3M9XCJlcnJvci1tZXNzYWdlIGhpZGRlblwiPjwvZGl2PlxyXG48L2Rpdj5cclxuYFxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRElGb3JtIGV4dGVuZHMgSFRNTEZvcm1FbGVtZW50e1xyXG5cclxuICBfaW5wdXRzXHJcbiAgX2Vycm9yTWVzc2FnZVxyXG4gIHN1Ym1pdEJ1dHRvblxyXG5cclxuICBjb25zdHJ1Y3RvcihvcHRpb25zKXtcclxuICAgIHN1cGVyKClcclxuXHJcbiAgICBvcHRpb25zID0ge1xyXG4gICAgICBhc3luYzogZmFsc2UsXHJcbiAgICAgIGFjdGlvbjogJycsXHJcbiAgICAgIHN1Ym1pdFRleHQ6ICdTdWJtaXQnLFxyXG4gICAgICBzdWNjZXNzOiAoKSA9PiB7fSxcclxuICAgICAgY3VzdG9tRmV0Y2g6IGZhbHNlLFxyXG4gICAgICBmdWxsc2NyZWVuTG9hZGluZzogZmFsc2UsXHJcbiAgICAgIGV4dHJhRGF0YToge30sXHJcbiAgICAgIGh0bWw6ICcnLFxyXG4gICAgICAuLi5vcHRpb25zXHJcbiAgICB9XHJcbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zXHJcblxyXG4gICAgdGhpcy5jbGFzc0xpc3QuYWRkKCdkaS1mb3JtJylcclxuICAgIHRoaXMuaW5uZXJIVE1MID0gSFRNTChvcHRpb25zLmh0bWwpXHJcbiAgICB0aGlzLl9pbnB1dHMgPSB0aGlzLnF1ZXJ5U2VsZWN0b3IoJy5pbnB1dHMnKVxyXG4gICAgdGhpcy5zdWJtaXRCdXR0b24gPSB0aGlzLnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbicpXHJcbiAgICB0aGlzLnN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IG9wdGlvbnMuc3VibWl0VGV4dFxyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlID0gdGhpcy5xdWVyeVNlbGVjdG9yKCcuZXJyb3ItbWVzc2FnZScpXHJcblxyXG4gICAgaWYob3B0aW9ucy5hY3Rpb24pe1xyXG4gICAgICB0aGlzLnNldEF0dHJpYnV0ZSgnYWN0aW9uJywgb3B0aW9ucy5hY3Rpb24pXHJcbiAgICB9XHJcblxyXG4gICAgaWYob3B0aW9ucy5hc3luYyl7XHJcbiAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgYXN5bmMgZSA9PiB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXHJcbiAgICAgICAgdGhpcy5fbG9hZGluZygpXHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gb3B0aW9ucy5hY3Rpb24gaW5zdGFuY2VvZiBGdW5jdGlvbiA/IGF3YWl0IG9wdGlvbnMuYWN0aW9uKCkgOiBhd2FpdCBmaXp6ZXRjaChvcHRpb25zLmFjdGlvbiwgdGhpcy5kYXRhKCkpXHJcbiAgICAgICAgdGhpcy5fbG9hZGluZ0ZpbmlzaGVkKClcclxuICAgICAgICBpZihyZXN1bHQuZXJyb3Ipe1xyXG4gICAgICAgICAgdGhpcy5lcnJvcihyZXN1bHQuZXJyb3IpXHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICBvcHRpb25zLnN1Y2Nlc3MocmVzdWx0KVxyXG4gICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnc3VjY2VzcycpKVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGRhdGEoKXtcclxuICAgIGNvbnN0IGRhdGEgPSBuZXcgRm9ybURhdGEodGhpcylcclxuICAgIGNvbnN0IG9iaiA9IHt9XHJcbiAgICBBcnJheS5mcm9tKGRhdGEuZW50cmllcygpKS5mb3JFYWNoKChba2V5LCB2YWxdKSA9PiBvYmpba2V5XSA9IHZhbClcclxuXHJcbiAgICBsZXQgZXh0cmEgPSB0aGlzLm9wdGlvbnMuZXh0cmFEYXRhXHJcbiAgICBleHRyYSA9IHR5cGVvZiBleHRyYSA9PT0gJ2Z1bmN0aW9uJyA/IGV4dHJhKCkgOiBleHRyYVxyXG4gICAgZXh0cmEgPSBleHRyYSA/IGV4dHJhIDoge31cclxuXHJcbiAgICByZXR1cm4geyAuLi5vYmosIC4uLmV4dHJhIH1cclxuICB9XHJcblxyXG4gIGFkZElucHV0KG9wdGlvbnMsIGxhYmVsID0gbnVsbCl7XHJcblxyXG4gICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpXHJcbiAgICBmb3IgKGxldCBrZXkgaW4gb3B0aW9ucyl7XHJcbiAgICAgIGlucHV0LnNldEF0dHJpYnV0ZShrZXksIG9wdGlvbnNba2V5XSlcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLl9hZGRJbnB1dChpbnB1dCwgbGFiZWwpXHJcbiAgfVxyXG5cclxuICBfYWRkSW5wdXQoaW5wdXRFbCwgbGFiZWwgPSBudWxsKXtcclxuXHJcbiAgICBjb25zdCBsYWJlbEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKVxyXG4gICAgaWYobGFiZWwpe1xyXG4gICAgICBjb25zdCBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpXHJcbiAgICAgIHNwYW4udGV4dENvbnRlbnQgPSBsYWJlbFxyXG4gICAgICBsYWJlbEVsLmFwcGVuZENoaWxkKHNwYW4pXHJcbiAgICB9XHJcblxyXG4gICAgbGFiZWxFbC5hcHBlbmRDaGlsZChpbnB1dEVsKVxyXG4gICAgdGhpcy5faW5wdXRzLmFwcGVuZENoaWxkKGxhYmVsRWwpXHJcbiAgfVxyXG5cclxuICBhZGRTZWxlY3Qob3B0aW9ucyl7XHJcblxyXG4gICAgb3B0aW9ucyA9IHtcclxuICAgICAgbGFiZWw6IG51bGwsXHJcbiAgICAgIG5hbWU6ICcnLFxyXG4gICAgICBvcHRpb25zTGlzdDogW10sXHJcbiAgICAgIC4uLm9wdGlvbnNcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJylcclxuICAgIGxhYmVsLmNsYXNzTGlzdC5hZGQoJ2ZsZXgtYmV0d2VlbicpXHJcbiAgICBpZihvcHRpb25zLmxhYmVsKXtcclxuICAgICAgY29uc3Qgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKVxyXG4gICAgICBzcGFuLnRleHRDb250ZW50ID0gb3B0aW9ucy5sYWJlbFxyXG4gICAgICBsYWJlbC5hcHBlbmRDaGlsZChzcGFuKVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NlbGVjdCcpXHJcbiAgICBzZWxlY3Quc2V0QXR0cmlidXRlKCduYW1lJywgb3B0aW9ucy5uYW1lKVxyXG4gICAgb3B0aW9ucy5vcHRpb25zTGlzdC5mb3JFYWNoKCh7IHZhbHVlLCBuYW1lIH0pID0+IHtcclxuICAgICAgY29uc3Qgb3B0aW9ucyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpXHJcbiAgICAgIG9wdGlvbnMudmFsdWUgPSB2YWx1ZVxyXG4gICAgICBvcHRpb25zLnRleHRDb250ZW50ID0gbmFtZVxyXG4gICAgICBzZWxlY3QuYXBwZW5kQ2hpbGQob3B0aW9ucylcclxuICAgIH0pXHJcbiAgICBsYWJlbC5hcHBlbmRDaGlsZChzZWxlY3QpXHJcblxyXG4gICAgdGhpcy5faW5wdXRzLmFwcGVuZENoaWxkKGxhYmVsKVxyXG4gICAgcmV0dXJuIHNlbGVjdFxyXG4gIH1cclxuXHJcbiAgZXJyb3IobWVzc2FnZSl7XHJcbiAgICBpZihtZXNzYWdlPy5tZXNzYWdlKXtcclxuICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UubWVzc2FnZVxyXG4gICAgfVxyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlLnRleHRDb250ZW50ID0gbWVzc2FnZVxyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpXHJcbiAgfVxyXG5cclxuICBfbG9hZGluZygpe1xyXG4gICAgaWYodGhpcy5vcHRpb25zLmZ1bGxzY3JlZW5Mb2FkaW5nKXtcclxuICAgICAgcmV0dXJuIHNob3dMb2FkZXIodGhpcy5vcHRpb25zLmZ1bGxzY3JlZW5Mb2FkaW5nLm1lc3NhZ2UgPz8gJycpXHJcbiAgICB9XHJcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2UuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJylcclxuICAgIHRoaXMuc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZVxyXG4gICAgdGhpcy5zdWJtaXRCdXR0b24uaW5uZXJIVE1MID0gJzxzcGFuIGNsYXNzPVwic3Bpbi1lZmZlY3RcIj5ESTwvc3Bhbj4nXHJcbiAgfVxyXG5cclxuICBfbG9hZGluZ0ZpbmlzaGVkKCl7XHJcbiAgICBpZih0aGlzLm9wdGlvbnMuZnVsbHNjcmVlbkxvYWRpbmcpe1xyXG4gICAgICByZXR1cm4gaGlkZUxvYWRlcigpXHJcbiAgICB9XHJcbiAgICB0aGlzLnN1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlXHJcbiAgICB0aGlzLnN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMub3B0aW9ucy5zdWJtaXRUZXh0XHJcbiAgfVxyXG59XHJcblxyXG5jdXN0b21FbGVtZW50cy5kZWZpbmUoJ2RpLWZvcm0nLCBESUZvcm0sIHsgZXh0ZW5kczogJ2Zvcm0nIH0pIiwiZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24odXJsLCBkYXRhID0gbnVsbCl7XHJcbiAgbGV0IHJlc3BcclxuICBsZXQgdGV4dFxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBvYmogPSB7XHJcbiAgICAgIG1ldGhvZDogJ3Bvc3QnLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYoZGF0YSl7XHJcbiAgICAgIG9iai5ib2R5ID0gSlNPTi5zdHJpbmdpZnkoZGF0YSlcclxuICAgIH1cclxuXHJcbiAgICByZXNwID0gYXdhaXQgZmV0Y2godXJsLCBvYmopXHJcbiAgICB0ZXh0ID0gYXdhaXQgcmVzcC50ZXh0KClcclxuICAgIHJldHVybiB0ZXh0ID8gSlNPTi5wYXJzZSh0ZXh0KSA6IHt9XHJcbiAgfWNhdGNoKGV4KXtcclxuICAgIGlmKCFyZXNwIHx8IHJlc3Auc3RhdHVzID49IDQwMCl7XHJcbiAgICAgIGlmKHRleHQpe1xyXG4gICAgICAgIHJldHVybiB7IGVycm9yOiB0ZXh0IH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4geyBlcnJvcjogZXggfHwgYEFuIGVycm9yIG9jY3VycmVkIGR1cmluZyBmaXp6ZXRjaCBvZiAke3VybH1gIH1cclxuICAgIH1cclxuICAgIHJldHVybiB7fVxyXG4gIH1cclxufSIsImltcG9ydCBESUZvcm0gZnJvbSAnLi4vY29tcG9uZW50cy9mb3JtLmpzJ1xyXG5cclxuY29uc3QgZGlmb3JtID0gbmV3IERJRm9ybSh7XHJcbiAgc3VibWl0VGV4dDogJ1NhdmUnXHJcbn0pXHJcbmRpZm9ybS5hZGRJbnB1dCh7XHJcbiAgdHlwZTogJ3RleHQnLFxyXG4gIG5hbWU6ICdkaXNwbGF5bmFtZScsXHJcbiAgbWluTGVuZ3RoOiAyLFxyXG4gIG1heExlbmd0aDogMTUsXHJcbiAgcmVxdWlyZWQ6ICdyZXF1aXJlZCcsXHJcbiAgcGxhY2Vob2xkZXI6ICdDaG9vc2UgYSB1c2VybmFtZSdcclxufSlcclxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5ldy11c2VyLWZvcm0nKS5hcHBlbmRDaGlsZChkaWZvcm0pXHJcblxyXG5pZih3aW5kb3cuRVJST1Ipe1xyXG4gIGRpZm9ybS5lcnJvcih3aW5kb3cuRVJST1IpXHJcbn1cclxuXHJcbiJdLCJuYW1lcyI6WyJsb2FkZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJESUZvcm0iLCJIVE1MRm9ybUVsZW1lbnQiLCJfaW5wdXRzIiwiX2Vycm9yTWVzc2FnZSIsInN1Ym1pdEJ1dHRvbiIsImNvbnN0cnVjdG9yIiwib3B0aW9ucyIsInN1cGVyIiwiYXN5bmMiLCJhY3Rpb24iLCJzdWJtaXRUZXh0Iiwic3VjY2VzcyIsImN1c3RvbUZldGNoIiwiZnVsbHNjcmVlbkxvYWRpbmciLCJleHRyYURhdGEiLCJodG1sIiwidGhpcyIsImNsYXNzTGlzdCIsImFkZCIsImlubmVySFRNTCIsInRleHRDb250ZW50Iiwic2V0QXR0cmlidXRlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJwcmV2ZW50RGVmYXVsdCIsIl9sb2FkaW5nIiwicmVzdWx0IiwiRnVuY3Rpb24iLCJ1cmwiLCJkYXRhIiwicmVzcCIsInRleHQiLCJvYmoiLCJtZXRob2QiLCJoZWFkZXJzIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJmZXRjaCIsInBhcnNlIiwiZXgiLCJzdGF0dXMiLCJlcnJvciIsImZpenpldGNoIiwiX2xvYWRpbmdGaW5pc2hlZCIsImRpc3BhdGNoRXZlbnQiLCJFdmVudCIsIkZvcm1EYXRhIiwiQXJyYXkiLCJmcm9tIiwiZW50cmllcyIsImZvckVhY2giLCJrZXkiLCJ2YWwiLCJleHRyYSIsImFkZElucHV0IiwibGFiZWwiLCJpbnB1dCIsImNyZWF0ZUVsZW1lbnQiLCJfYWRkSW5wdXQiLCJpbnB1dEVsIiwibGFiZWxFbCIsInNwYW4iLCJhcHBlbmRDaGlsZCIsImFkZFNlbGVjdCIsIm5hbWUiLCJvcHRpb25zTGlzdCIsInNlbGVjdCIsInZhbHVlIiwibWVzc2FnZSIsInJlbW92ZSIsInNob3dMb2FkZXIiLCJkaXNhYmxlZCIsImN1c3RvbUVsZW1lbnRzIiwiZGVmaW5lIiwiZXh0ZW5kcyIsImRpZm9ybSIsInR5cGUiLCJtaW5MZW5ndGgiLCJtYXhMZW5ndGgiLCJyZXF1aXJlZCIsInBsYWNlaG9sZGVyIiwid2luZG93IiwiRVJST1IiXSwic291cmNlUm9vdCI6IiJ9